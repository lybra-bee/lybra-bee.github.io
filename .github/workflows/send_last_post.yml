name: Send Latest Post to Telegram
on:
  push:
    branches:
      - main
jobs:
  send_post:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'
      - name: Extract front-matter
        run: |
          pip install python-frontmatter
          python -c "
          import frontmatter
          post = frontmatter.load('_posts/$(ls -t _posts | head -n 1)')
          print('TITLE=' + post['title'] + '\nDATE=' + str(post['date']) + '\nSLUG=' + post['slug'] + '\nPOST_NUM=' + post.get('image', '')) >> $GITHUB_ENV
          "
      - name: Check variables and send to Telegram
        run: |
          if [ -z "$TITLE" ]; then
            echo "::error::TITLE is empty"
            exit 1
          fi
          if [ -z "$DATE" ]; then
            echo "::error::DATE is empty"
            exit 1
          fi
          if [ -z "$SLUG" ]; then
            echo "::error::SLUG is empty"
            exit 1
          fi
          if [ -z "$POST_NUM" ]; then
            echo "::error::POST_NUM is empty, check front-matter 'image' in post"
            exit 1
          fi
          # Add your Telegram sending logic here
