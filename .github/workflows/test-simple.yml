name: üß™ Simple File Test

on:
  workflow_dispatch:

permissions:
  contents: write

jobs:
  test-file-creation:
    runs-on: ubuntu-latest
    steps:
      - name: üì• Checkout repository
        uses: actions/checkout@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          
      - name: üìÅ Create directory structure
        run: |
          echo "–°–æ–∑–¥–∞–µ–º –ø–∞–ø–∫–∏..."
          mkdir -p content/posts
          echo "–¢–µ–∫—É—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:"
          pwd
          ls -la
          ls -la content/ || echo "No content dir"
          
      - name: üìù Create test file
        run: |
          echo "–°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª..."
          
          # –°–æ–∑–¥–∞–µ–º —Ñ–∞–π–ª –ø—Ä–æ—Å—Ç—ã–º —Å–ø–æ—Å–æ–±–æ–º
          echo "---" > content/posts/test-file.md
          echo "title: '–¢–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª'" >> content/posts/test-file.md
          echo "date: 2024-01-20T10:00:00+03:00" >> content/posts/test-file.md
          echo "draft: false" >> content/posts/test-file.md
          echo "---" >> content/posts/test-file.md
          echo "" >> content/posts/test-file.md
          echo "# –≠—Ç–æ —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª" >> content/posts/test-file.md
          echo "" >> content/posts/test-file.md
          echo "–°–æ–∑–¥–∞–Ω–æ: $(date)" >> content/posts/test-file.md
          
          echo "–§–∞–π–ª —Å–æ–∑–¥–∞–Ω! –ü—Ä–æ–≤–µ—Ä—è–µ–º:"
          ls -la content/posts/
          cat content/posts/test-file.md
          
      - name: üíæ Commit and push
        run: |
          echo "–ö–æ–º–º–∏—Ç–∏–º –∏–∑–º–µ–Ω–µ–Ω–∏—è..."
          git config --global user.email "github-actions[bot]@users.noreply.github.com"
          git config --global user.name "github-actions[bot]"
          
          git add content/posts/test-file.md
          git status
          
          if ! git diff --staged --quiet; then
            git commit -m "–î–æ–±–∞–≤–ª–µ–Ω —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª"
            git push
            echo "‚úÖ –§–∞–π–ª —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω –∏ –∑–∞–ø—É—à–µ–Ω!"
          else
            echo "‚ùå –ù–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –¥–ª—è –∫–æ–º–º–∏—Ç–∞"
          fi
