name: ðŸ§ª Simple File Test

on:
  workflow_dispatch:

permissions:
  contents: write  # â† Ð”ÐÐ•Ðœ ÐŸÐ ÐÐ’Ð ÐÐ Ð—ÐÐŸÐ˜Ð¡Ð¬!

jobs:
  test-file-creation:
    runs-on: ubuntu-latest
    steps:
      - name: ðŸ“¥ Checkout repository
        uses: actions/checkout@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          
      - name: ðŸ“ Create directory structure
        run: |
          echo "Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ð¿Ð°Ð¿ÐºÐ¸..."
          mkdir -p content/posts
          echo "Ð¢ÐµÐºÑƒÑ‰Ð°Ñ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð°:"
          pwd
          ls -la
          ls -la content/ || echo "No content dir"
          
      - name: ðŸ“ Create test file
        run: |
          echo "Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ñ‚ÐµÑÑ‚Ð¾Ð²Ñ‹Ð¹ Ñ„Ð°Ð¹Ð»..."
          cat > content/posts/test-file.md << EOF
---
title: "Ð¢ÐµÑÑ‚Ð¾Ð²Ñ‹Ð¹ Ñ„Ð°Ð¹Ð»"
date: 2024-01-20T10:00:00+03:00
draft: false
---

# Ð­Ñ‚Ð¾ Ñ‚ÐµÑÑ‚Ð¾Ð²Ñ‹Ð¹ Ñ„Ð°Ð¹Ð»

Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¾: $(date)
EOF
          
          echo "Ð¤Ð°Ð¹Ð» ÑÐ¾Ð·Ð´Ð°Ð½! ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼:"
          ls -la content/posts/
          cat content/posts/test-file.md
          
      - name: ðŸ’¾ Commit and push
        run: |
          echo "ÐšÐ¾Ð¼Ð¼Ð¸Ñ‚Ð¸Ð¼ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ñ..."
          git config --global user.email "github-actions[bot]@users.noreply.github.com"
          git config --global user.name "github-actions[bot]"
          
          git add content/posts/test-file.md
          git status
          
          if ! git diff --staged --quiet; then
            git commit -m "Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½ Ñ‚ÐµÑÑ‚Ð¾Ð²Ñ‹Ð¹ Ñ„Ð°Ð¹Ð»"
            git push
            echo "âœ… Ð¤Ð°Ð¹Ð» ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½ Ð¸ Ð·Ð°Ð¿ÑƒÑˆÐµÐ½!"
          else
            echo "âŒ ÐÐµÑ‚ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ð¹ Ð´Ð»Ñ ÐºÐ¾Ð¼Ð¼Ð¸Ñ‚Ð°"
          fi
