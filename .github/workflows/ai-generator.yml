name: ğŸ¤– AI Content Generator

on:
  schedule:
    - cron: '0 11 * * *'  # Ğ•Ğ¶ĞµĞ´Ğ½ĞµĞ²Ğ½Ğ¾ Ğ² 11:00 UTC (14:00 ĞœĞ¡Ğš)
  workflow_dispatch:       # Ğ ÑƒÑ‡Ğ½Ğ¾Ğ¹ Ğ·Ğ°Ğ¿ÑƒÑĞº
  push:
    branches: [main]
    paths:
      - '.github/workflows/ai-generator.yml'

permissions:
  contents: write

jobs:
  generate-ai-content:
    runs-on: ubuntu-latest
    timeout-minutes: 10
    
    steps:
    - name: â¬‡ï¸ Checkout repository
      uses: actions/checkout@v4
      with:
        fetch-depth: 0
        token: ${{ secrets.GITHUB_TOKEN }}

    - name: ğŸ Setup Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.10'

    - name: ğŸ“¦ Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install requests

    - name: ğŸ“ Create directory structure
      run: |
        echo "Creating necessary directories..."
        mkdir -p content/posts
        mkdir -p assets/images/posts
        mkdir -p static/css
        mkdir -p layouts/_default
        mkdir -p layouts/partials
        echo "âœ… Directory structure ready"

    - name: ğŸ” Check for existing content generator
      run: |
        echo "Looking for content generation scripts..."
        if [ -f ".github/scripts/generate_content.py" ]; then
            echo "âœ… Found: .github/scripts/generate_content.py"
        elif [ -f "generate_content.py" ]; then
            echo "âœ… Found: generate_content.py"
        else
            echo "ğŸ“ No generator found, will create sample content"
        fi

    - name: ğŸš€ Generate AI content
      env:
        OPENROUTER_API_KEY: ${{ secrets.OPENROUTER_API_KEY }}
        GROQ_API_KEY: ${{ secrets.GROQ_API_KEY }}
        STABILITYAI_KEY: ${{ secrets.STABILITYAI_KEY }}
      run: |
        echo "Starting content generation..."
        
        # Create sample content if no generator found
        if [ ! -f ".github/scripts/generate_content.py" ] && [ ! -f "generate_content.py" ]; then
            echo "ğŸ“ Creating sample AI content..."
            
            cat > generate_sample.py << 'EOF'
import os
import random
from datetime import datetime, timedelta

def main():
    print("ğŸ¯ Generating sample AI content...")
    
    topics = [
        "Ğ˜ÑĞºÑƒÑÑÑ‚Ğ²ĞµĞ½Ğ½Ñ‹Ğ¹ Ğ¸Ğ½Ñ‚ĞµĞ»Ğ»ĞµĞºÑ‚ 2025: Ğ½Ğ¾Ğ²Ñ‹Ğµ Ğ³Ğ¾Ñ€Ğ¸Ğ·Ğ¾Ğ½Ñ‚Ñ‹ Ğ¸ Ğ²Ñ‹Ğ·Ğ¾Ğ²Ñ‹",
        "Ğ“Ğ»ÑƒĞ±Ğ¾ĞºĞ¾Ğµ Ğ¾Ğ±ÑƒÑ‡ĞµĞ½Ğ¸Ğµ: ÑĞ¾Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ñ‹ Ğ½ĞµĞ¹Ñ€Ğ¾ÑĞµÑ‚ĞµĞ¹", 
        "Generative AI: Ñ‚Ğ²Ğ¾Ñ€Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ¸ Ğ¸Ğ½Ğ½Ğ¾Ğ²Ğ°Ñ†Ğ¸Ğ¸",
        "ĞšĞ¾Ğ¼Ğ¿ÑŒÑÑ‚ĞµÑ€Ğ½Ğ¾Ğµ Ğ·Ñ€ĞµĞ½Ğ¸Ğµ: Ğ¾Ñ‚ Ñ€Ğ°ÑĞ¿Ğ¾Ğ·Ğ½Ğ°Ğ²Ğ°Ğ½Ğ¸Ñ Ğº Ğ¿Ğ¾Ğ½Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ñ",
        "ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° ĞµÑÑ‚ĞµÑÑ‚Ğ²ĞµĞ½Ğ½Ğ¾Ğ³Ğ¾ ÑĞ·Ñ‹ĞºĞ°: Ğ½Ğ¾Ğ²Ñ‹Ğµ Ğ¿Ğ¾Ğ´Ñ…Ğ¾Ğ´Ñ‹",
        "ĞĞ²Ñ‚Ğ¾Ğ½Ğ¾Ğ¼Ğ½Ñ‹Ğµ ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹ Ğ¸ Ñ€Ğ¾Ğ±Ğ¾Ñ‚Ğ¾Ñ‚ĞµÑ…Ğ½Ğ¸ĞºĞ°",
        "Ğ­Ñ‚Ğ¸ĞºĞ° Ğ¸ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ Ğ¸ÑĞºÑƒÑÑÑ‚Ğ²ĞµĞ½Ğ½Ğ¾Ğ³Ğ¾ Ğ¸Ğ½Ñ‚ĞµĞ»Ğ»ĞµĞºÑ‚Ğ°",
        "AI Ğ² healthcare: Ğ´Ğ¸Ğ°Ğ³Ğ½Ğ¾ÑÑ‚Ğ¸ĞºĞ° Ğ¸ Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ğµ Ğ±ÑƒĞ´ÑƒÑ‰ĞµĞ³Ğ¾"
    ]
    
    os.makedirs("content/posts", exist_ok=True)
    
    num_articles = random.randint(2, 4)
    print(f"ğŸ“Š Generating {num_articles} articles...")
    
    for i in range(num_articles):
        topic = random.choice(topics)
        date = (datetime.now() - timedelta(days=i)).strftime("%Y-%m-%d")
        slug = f"ai-article-{i+1}"
        filename = f"content/posts/{date}-{slug}.md"
        
        content = f"""---
title: "{topic}"
date: {date}
tags: ["AI", "Ğ¼Ğ°ÑˆĞ¸Ğ½Ğ½Ğ¾Ğµ Ğ¾Ğ±ÑƒÑ‡ĞµĞ½Ğ¸Ğµ", "2025"]
draft: false
---

## Ğ’Ğ²ĞµĞ´ĞµĞ½Ğ¸Ğµ
{topic} Ğ¿Ñ€ĞµĞ´ÑÑ‚Ğ°Ğ²Ğ»ÑĞµÑ‚ ÑĞ¾Ğ±Ğ¾Ğ¹ rapidly Ñ€Ğ°Ğ·Ğ²Ğ¸Ğ²Ğ°ÑÑ‰ÑƒÑÑÑ Ğ¾Ğ±Ğ»Ğ°ÑÑ‚ÑŒ Ñ Ğ¾Ğ³Ñ€Ğ¾Ğ¼Ğ½Ñ‹Ğ¼ Ğ¿Ğ¾Ñ‚ĞµĞ½Ñ†Ğ¸Ğ°Ğ»Ğ¾Ğ¼.

## ĞÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğµ Ğ½Ğ°Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ
- **Ğ¢ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ¸Ğ½Ğ½Ğ¾Ğ²Ğ°Ñ†Ğ¸Ğ¸**: ĞĞ¾Ğ²Ñ‹Ğµ Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼Ñ‹ Ğ¸ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ñ‹
- **ĞŸÑ€Ğ°ĞºÑ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ Ğ¿Ñ€Ğ¸Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğµ**: Ğ ĞµĞ°Ğ»ÑŒĞ½Ñ‹Ğµ Ğ±Ğ¸Ğ·Ğ½ĞµÑ-ĞºĞµĞ¹ÑÑ‹  
- **Ğ‘ÑƒĞ´ÑƒÑ‰ĞµĞµ Ñ€Ğ°Ğ·Ğ²Ğ¸Ñ‚Ğ¸Ğµ**: ĞŸĞµÑ€ÑĞ¿ĞµĞºÑ‚Ğ¸Ğ²Ñ‹ Ğ¸ Ñ‚Ñ€ĞµĞ½Ğ´Ñ‹

## Ğ¢ĞµÑ…Ğ½Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ´ĞµÑ‚Ğ°Ğ»Ğ¸
Ğ¡Ğ¾Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ Ğ¿Ğ¾Ğ´Ñ…Ğ¾Ğ´Ñ‹ Ğ²ĞºĞ»ÑÑ‡Ğ°ÑÑ‚ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ³Ğ»ÑƒĞ±Ğ¾ĞºĞ¸Ñ… Ğ½ĞµĞ¹Ñ€Ğ¾Ğ½Ğ½Ñ‹Ñ… ÑĞµÑ‚ĞµĞ¹, Ñ‚Ñ€Ğ°Ğ½ÑÑ„Ğ¾Ñ€Ğ¼ĞµÑ€Ğ¾Ğ² Ğ¸ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ‚Ğ¸Ğ²Ğ½Ñ‹Ñ… Ğ¼Ğ¾Ğ´ĞµĞ»ĞµĞ¹.

## Ğ—Ğ°ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ
{topic} Ğ¿Ñ€Ğ¾Ğ´Ğ¾Ğ»Ğ¶Ğ°ĞµÑ‚ revolutionĞ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ñ€Ğ°Ğ·Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ğµ Ğ¾Ñ‚Ñ€Ğ°ÑĞ»Ğ¸ Ğ¸ Ğ¾Ñ‚ĞºÑ€Ñ‹Ğ²Ğ°Ñ‚ÑŒ Ğ½Ğ¾Ğ²Ñ‹Ğµ Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚Ğ¸.
"""
        
        with open(filename, 'w', encoding='utf-8') as f:
            f.write(content)
        
        print(f"âœ… Created: {filename}")
    
    print("ğŸ‰ Content generation completed!")

if __name__ == "__main__":
    main()
EOF

            python generate_sample.py
        else
            echo "ğŸ”§ Running existing content generator..."
            if [ -f ".github/scripts/generate_content.py" ]; then
                cd .github/scripts/
                python generate_content.py
                cd ../../
            else
                python generate_content.py
            fi
        fi

    - name: ğŸ“Š List generated content
      run: |
        echo "ğŸ“ Generated files:"
        find content/ -name "*.md" -exec echo "   ğŸ“„ {}" \;
        echo "Total articles: $(find content/ -name "*.md" | wc -l)"

    - name: ğŸ’¾ Commit and push changes
      run: |
        git config --global user.name "GitHub Actions"
        git config --global user.email "github-actions@github.com"
        
        git add content/
        
        if git diff --cached --quiet; then
          echo "â„¹ï¸ No changes to commit"
        else
          git commit -m "ğŸ¤– Auto-generated AI content: $(date +'%Y-%m-%d %H:%M')"
          git push origin main
          echo "âœ… Changes pushed successfully"
        fi

    - name: ğŸ‰ Completion message
      run: |
        echo "=========================================="
        echo "ğŸ¤– AI CONTENT GENERATION COMPLETE"
        echo "=========================================="
        echo "ğŸ“… Generated: $(date)"
        echo "ğŸ“Š Articles: $(find content/ -name "*.md" | wc -l)"
        echo "ğŸŒ Site will update on next deployment"
        echo "=========================================="
