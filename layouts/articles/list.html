{{ define "main" }}
<h1>Статьи</h1>

<div class="carousel" id="articles-carousel">
  <button class="carousel-btn prev">&#10094;</button>
  <div class="carousel-track">
    {{ $posts := site.GetPage "section" "posts" }}
    {{ range $posts.Pages.ByDate.Reverse }}
    <div class="carousel-item">
      <a href="{{ .RelPermalink }}">
        {{ with .Params.image }}
          <img src="{{ . | relURL }}" alt="{{ .Title }}">
        {{ end }}
        <h3>{{ .Title }}</h3>
        {{ with .Params.description }}
          <p>{{ . | truncate 100 }}</p>
        {{ end }}
      </a>
    </div>
    {{ end }}
  </div>
  <button class="carousel-btn next">&#10095;</button>
</div>

<script>
  const track = document.querySelector('#articles-carousel .carousel-track');
  const items = track.children;
  const nextBtn = document.querySelector('#articles-carousel .next');
  const prevBtn = document.querySelector('#articles-carousel .prev');
  let index = 0;

  function updateCarousel() {
    const width = items[0].offsetWidth + 20;
    track.style.transform = `translateX(-${index * width}px)`;
  }

  nextBtn.addEventListener('click', () => {
    index = (index + 1) % items.length;
    updateCarousel();
  });

  prevBtn.addEventListener('click', () => {
    index = (index - 1 + items.length) % items.length;
    updateCarousel();
  });

  // Автопрокрутка каждые 4 секунды
  setInterval(() => {
    index = (index + 1) % items.length;
    updateCarousel();
  }, 4000);
</script>

<style>
.carousel {
  position: relative;
  overflow: hidden;
  width: 100%;
  margin: 2rem 0;
}
.carousel-track {
  display: flex;
  transition: transform 0.5s ease;
}
.carousel-item {
  min-width: 300px;
  margin-right: 20px;
  background: #f5f5f5;
  padding: 10px;
  border-radius: 8px;
}
.carousel-item img {
  width: 100%;
  height: auto;
  display: block;
  border-radius: 4px;
}
.carousel-btn {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  background: rgba(0,0,0,0.4);
  color: #fff;
  border: none;
  font-size: 2rem;
  padding: 0 10px;
  cursor: pointer;
  z-index: 10;
}
.carousel-btn.prev { left: 0; }
.carousel-btn.next { right: 0; }
</style>

{{ end }}
