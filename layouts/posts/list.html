{{ define "main" }}
<section class="posts-carousel-section">
  <h1>Статьи</h1>

  {{ $pages := .Pages.ByDate.Reverse }}
  {{ if $pages }}
  <div class="posts-carousel" id="posts-carousel">
    {{ range $pages }}
    <div class="carousel-item">
      <a href="{{ .RelPermalink }}">
        {{ with .Params.image }}
        <img src="{{ . }}" alt="{{ $.Title }}" />
        {{ end }}
        <div class="carousel-caption">
          <h3>{{ .Title }}</h3>
          <p>{{ .Date.Format "2006-01-02" }}</p>
        </div>
      </a>
    </div>
    {{ end }}
  </div>
  {{ else }}
  <p>Статей пока нет.</p>
  {{ end }}
</section>

<style>
.posts-carousel-section { max-width: 1200px; margin: auto; padding: 2rem; }
.posts-carousel { display: flex; overflow: hidden; scroll-behavior: smooth; }
.carousel-item { flex: 0 0 300px; margin-right: 20px; border: 1px solid #ddd; border-radius: 8px; overflow: hidden; }
.carousel-item img { width: 100%; height: 180px; object-fit: cover; }
.carousel-caption { padding: 0.5rem; text-align: center; }
</style>

<script>
const carousel = document.getElementById('posts-carousel');
let scrollAmount = 0;
function autoScroll() {
  if (!carousel) return;
  scrollAmount += 1;
  if (scrollAmount >= carousel.scrollWidth - carousel.clientWidth) scrollAmount = 0;
  carousel.scrollTo({ left: scrollAmount, behavior: 'smooth' });
}
setInterval(autoScroll, 50);
</script>
{{ end }}
