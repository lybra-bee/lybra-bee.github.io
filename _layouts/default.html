<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{ page.title | default: site.title }}</title>
  <link rel="stylesheet" href="/assets/css/main.css">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üêù</text></svg>" type="image/svg+xml">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="{% if site.dark_mode or page.dark_mode %}dark-mode{% endif %}">
  <header class="hero">
    <div class="hero-content">
      <h1>{{ page.title | default: site.title }}</h1>
      {% if page.description %}<p>{{ page.description }}</p>{% endif %}
      <nav class="nav-menu">
        <a href="/" class="nav-link">–ì–ª–∞–≤–Ω–∞—è</a>
        <a href="/articles/" class="nav-link">–°—Ç–∞—Ç—å–∏</a>
        <a href="/about/" class="nav-link">–û–±–æ –º–Ω–µ</a>
        <a href="/gallery/" class="nav-link">–ì–∞–ª–µ—Ä–µ—è</a>
      </nav>
      <button id="theme-toggle" class="theme-toggle btn btn-outline-light mt-3">
        {% if site.dark_mode or page.dark_mode %}–°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞{% else %}–¢–µ–º–Ω–∞—è —Ç–µ–º–∞{% endif %}
      </button>
    </div>
  </header>

  <main>
    <section class="welcome-section">
      <h2 class="spread-text">
        –î&nbsp;–æ&nbsp;–±&nbsp;—Ä&nbsp;–æ&nbsp;
        –ø&nbsp;–æ&nbsp;–∂&nbsp;–∞&nbsp;–ª&nbsp;–æ&nbsp;–≤&nbsp;–∞&nbsp;—Ç&nbsp;—å&nbsp;
        –≤&nbsp;–º&nbsp;–æ&nbsp;–π&nbsp;
        –±&nbsp;–ª&nbsp;–æ&nbsp;–≥
      </h2>
    </section>

    {{ content }}
  </main>

  <footer class="footer">
    <p>&copy; {{ site.time | date: '%Y' }} Lybra Bee. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
  <script>
    // –¢–µ–º–Ω–∞—è —Ç–µ–º–∞
    document.getElementById('theme-toggle').addEventListener('click', function() {
      document.body.classList.toggle('dark-mode');
      this.textContent = document.body.classList.contains('dark-mode') ? '–°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞' : '–¢–µ–º–Ω–∞—è —Ç–µ–º–∞';
    });

    // –ë–µ–≥—É—â–∞—è —Å—Ç—Ä–æ–∫–∞: –ø–∞—Ä—ã –±—É–∫–≤ —Å –ø—Ä–æ–±–µ–ª–∞–º–∏
    document.addEventListener("DOMContentLoaded", () => {
      const textContainer = document.querySelector(".spread-text");
      if (!textContainer) return;
      const letters = Array.from(textContainer.childNodes).filter(n => n.nodeType === Node.TEXT_NODE || n.nodeType === Node.ELEMENT_NODE);
      const midX = textContainer.offsetWidth / 2;

      letters.forEach((span, idx) => {
        if(span.nodeType === Node.TEXT_NODE) {
          const txt = span.textContent.split('').map(c => `<span>${c === ' ' ? '\u00A0' : c}</span>`).join('');
          const temp = document.createElement('span');
          temp.innerHTML = txt;
          span.replaceWith(...Array.from(temp.childNodes));
        }
      });

      const allSpans = Array.from(textContainer.querySelectorAll('span'));
      allSpans.forEach(span => {
        const rect = span.getBoundingClientRect();
        const containerRect = textContainer.getBoundingClientRect();
        const finalX = rect.left - containerRect.left;
        span.dataset.finalX = finalX;
        span.style.transform = `translateX(${midX - finalX}px)`;
        span.style.opacity = 0;
      });

      let pairIndex = 0;

      function animatePair() {
        if (pairIndex >= Math.ceil(allSpans.length / 2)) {
          setTimeout(resetAnimation, 1500);
          return;
        }
        const left = allSpans[pairIndex];
        const right = allSpans[allSpans.length - 1 - pairIndex];
        [left, right].forEach(span => {
          if (span) {
            span.style.transition = "transform 0.4s ease, opacity 0.2s ease";
            span.style.opacity = 1;
            span.style.transform = `translateX(0)`;
          }
        });
        pairIndex++;
        setTimeout(animatePair, 150);
      }

      function resetAnimation() {
        allSpans.forEach(span => {
          const finalX = span.dataset.finalX;
          span.style.transition = "none";
          span.style.transform = `translateX(${midX - finalX}px)`;
          span.style.opacity = 0;
        });
        pairIndex = 0;
        setTimeout(animatePair, 300);
      }

      animatePair();
    });
  </script>
</body>
</html>
