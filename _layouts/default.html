<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{ page.title | default: site.title }}</title>
  <link rel="stylesheet" href="/assets/css/main.css">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üêù</text></svg>" type="image/svg+xml">
</head>
<body class="{% if site.dark_mode or page.dark_mode %}dark-mode{% endif %}">
  <header class="hero">
    <div class="hero-content">
      <h1>{{ page.title | default: site.title }}</h1>
      {% if page.description %}<p>{{ page.description }}</p>{% endif %}
      <nav class="nav-menu">
        <a href="/" class="nav-link">–ì–ª–∞–≤–Ω–∞—è</a>
        <a href="/articles/" class="nav-link">–°—Ç–∞—Ç—å–∏</a>
        <a href="/about/" class="nav-link">–û–±–æ –º–Ω–µ</a>
        <a href="/gallery/" class="nav-link">–ì–∞–ª–µ—Ä–µ—è</a>
      </nav>
      <button id="theme-toggle" class="theme-toggle btn btn-outline-light mt-3">
        {% if site.dark_mode or page.dark_mode %}–°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞{% else %}–¢–µ–º–Ω–∞—è —Ç–µ–º–∞{% endif %}
      </button>
    </div>
  </header>

  <main>
    <section class="welcome-section">
      <h2 class="spread-text">
        <span>–î</span><span>–æ</span><span>–±</span><span>—Ä</span><span>–æ</span>
        <span> </span><span>–ø</span><span>–æ</span><span>–∂</span><span>–∞</span><span>–ª</span><span>–æ</span><span>–≤</span><span>–∞</span><span>—Ç</span><span>—å</span>
        <span> </span><span>–≤</span><span> </span><span>–º</span><span>–æ</span><span>–π</span>
        <span> </span><span>–±</span><span>–ª</span><span>–æ</span><span>–≥</span>
      </h2>
    </section>

    {{ content }}
  </main>

  <footer class="footer">
    <p>&copy; {{ site.time | date: '%Y' }} Lybra Bee. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>

  <script>
  // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ–º—ã
  document.getElementById('theme-toggle').addEventListener('click', function() {
    document.body.classList.toggle('dark-mode');
    this.textContent = document.body.classList.contains('dark-mode') ? '–°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞' : '–¢–µ–º–Ω–∞—è —Ç–µ–º–∞';
  });

  // –ê–Ω–∏–º–∞—Ü–∏—è –±–µ–≥—É—â–µ–π —Å—Ç—Ä–æ–∫–∏
  document.addEventListener("DOMContentLoaded", () => {
    const textContainer = document.querySelector(".spread-text");
    if (!textContainer) return;
    const letters = Array.from(textContainer.querySelectorAll("span"));
    const midX = textContainer.offsetWidth / 2;

    // —Å–æ—Ö—Ä–∞–Ω—è–µ–º –∫–æ–Ω–µ—á–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏
    letters.forEach(span => {
      const rect = span.getBoundingClientRect();
      const containerRect = textContainer.getBoundingClientRect();
      const finalX = rect.left - containerRect.left;
      span.dataset.finalX = finalX;
      span.style.transform = `translateX(${midX - finalX}px)`; // —Å—Ç–∞—Ä—Ç –≤ —Ü–µ–Ω—Ç—Ä–µ
      span.style.opacity = 0;
    });

    let pairIndex = 0;

    function animatePair() {
      if (pairIndex >= Math.ceil(letters.length / 2)) {
        setTimeout(resetAnimation, 1500); // –ø–∞—É–∑–∞ –ø–µ—Ä–µ–¥ —Ü–∏–∫–ª–æ–º
        return;
      }

      const left = letters[pairIndex];
      const right = letters[letters.length - 1 - pairIndex];

      [left, right].forEach(span => {
        if (span) {
          span.style.transition = "transform 0.6s ease, opacity 0.3s ease";
          span.style.opacity = 1;
          span.style.transform = `translateX(0)`; // –µ–¥—É—Ç –Ω–∞ —Å–≤–æ–∏ –º–µ—Å—Ç–∞
        }
      });

      pairIndex++;
      setTimeout(animatePair, 200); // —Å–∫–æ—Ä–æ—Å—Ç—å –∞–Ω–∏–º–∞—Ü–∏–∏
    }

    function resetAnimation() {
      letters.forEach(span => {
        const finalX = span.dataset.finalX;
        span.style.transition = "none";
        span.style.transform = `translateX(${midX - finalX}px)`;
        span.style.opacity = 0;
      });
      pairIndex = 0;
      setTimeout(animatePair, 300); // –Ω–æ–≤—ã–π —Ü–∏–∫–ª
    }

    animatePair();

    // ---------------------------
    // 3D –∫–∞—Ä—É—Å–µ–ª—å —Å—Ç–∞—Ç–µ–π
    const track = document.querySelector('.carousel-3d-track');
    if (!track) return;

    const items = Array.from(track.children);
    const prevBtn = document.querySelector('.carousel-3d-controls .prev');
    const nextBtn = document.querySelector('.carousel-3d-controls .next');
    let currentIndex = 0;

    function updateCarousel() {
      items.forEach((item, i) => {
        item.classList.remove('prev2', 'prev', 'active', 'next', 'next2');
        if (i === currentIndex) item.classList.add('active');
        if (i === currentIndex - 1) item.classList.add('prev');
        if (i === currentIndex - 2) item.classList.add('prev2');
        if (i === currentIndex + 1) item.classList.add('next');
        if (i === currentIndex + 2) item.classList.add('next2');
      });
    }

    prevBtn.addEventListener('click', () => {
      currentIndex = (currentIndex - 1 + items.length) % items.length;
      updateCarousel();
    });

    nextBtn.addEventListener('click', () => {
      currentIndex = (currentIndex + 1) % items.length;
      updateCarousel();
    });

    setInterval(() => {
      currentIndex = (currentIndex + 1) % items.length;
      updateCarousel();
    }, 4000);

    updateCarousel();
  });
  </script>
</body>
</html>
